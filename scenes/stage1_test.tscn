[gd_scene load_steps=10 format=3 uid="uid://stage1test"]

[ext_resource type="Script" path="res://scenes/player/first_person_controller.gd" id="1_controller"]
[ext_resource type="Script" path="res://scripts/components/interaction_raycast.gd" id="2_raycast"]
[ext_resource type="Script" path="res://scenes/ui/debug_overlay.gd" id="3_debug"]
[ext_resource type="Script" path="res://scripts/components/simple_interactable.gd" id="4_interact"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_player"]
radius = 0.5
height = 2.0

[sub_resource type="BoxMesh" id="BoxMesh_floor"]
size = Vector3(30, 0.5, 30)

[sub_resource type="BoxShape3D" id="BoxShape3D_floor"]
size = Vector3(30, 0.5, 30)

[sub_resource type="BoxMesh" id="BoxMesh_wall"]
size = Vector3(1, 3, 10)

[sub_resource type="BoxShape3D" id="BoxShape3D_wall"]
size = Vector3(1, 3, 10)

[sub_resource type="SphereMesh" id="SphereMesh_pickup"]
radius = 0.3
height = 0.6

[sub_resource type="SphereShape3D" id="SphereShape3D_pickup"]
radius = 0.5

[sub_resource type="BoxMesh" id="BoxMesh_crate"]
size = Vector3(1, 1, 1)

[sub_resource type="BoxShape3D" id="BoxShape3D_crate"]
size = Vector3(1, 1, 1)

[node name="Stage1Test" type="Node3D"]

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_1")

[sub_resource type="Environment" id="Environment_1"]
background_mode = 1
background_color = Color(0.3, 0.3, 0.35, 1)
ambient_light_source = 3
ambient_light_color = Color(0.7, 0.7, 0.8, 1)
ambient_light_energy = 0.5

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(0.866025, -0.433013, 0.25, 0, 0.5, 0.866025, -0.5, -0.75, 0.433013, 0, 10, 5)
shadow_enabled = true

[node name="Floor" type="StaticBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.25, 0)

[node name="MeshInstance3D" type="MeshInstance3D" parent="Floor"]
mesh = SubResource("BoxMesh_floor")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Floor"]
shape = SubResource("BoxShape3D_floor")

[node name="LeftWall" type="StaticBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -10, 1.5, 0)

[node name="MeshInstance3D" type="MeshInstance3D" parent="LeftWall"]
mesh = SubResource("BoxMesh_wall")

[node name="CollisionShape3D" type="CollisionShape3D" parent="LeftWall"]
shape = SubResource("BoxShape3D_wall")

[node name="RightWall" type="StaticBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 10, 1.5, 0)

[node name="MeshInstance3D" type="MeshInstance3D" parent="RightWall"]
mesh = SubResource("BoxMesh_wall")

[node name="CollisionShape3D" type="CollisionShape3D" parent="RightWall"]
shape = SubResource("BoxShape3D_wall")

[node name="BackWall" type="StaticBody3D" parent="."]
transform = Transform3D(-4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, 0, 1.5, -5)

[node name="MeshInstance3D" type="MeshInstance3D" parent="BackWall"]
mesh = SubResource("BoxMesh_wall")

[node name="CollisionShape3D" type="CollisionShape3D" parent="BackWall"]
shape = SubResource("BoxShape3D_wall")

[node name="PickupExample1" type="StaticBody3D" parent="." groups=["interactables"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -3, 0.8, -2)
collision_layer = 2
collision_mask = 0
script = ExtResource("4_interact")
interaction_prompt = "Press [E] to pick up health potion"
one_time_use = true

[node name="MeshInstance3D" type="MeshInstance3D" parent="PickupExample1"]
mesh = SubResource("SphereMesh_pickup")

[node name="CollisionShape3D" type="CollisionShape3D" parent="PickupExample1"]
shape = SubResource("SphereShape3D_pickup")

[node name="PickupExample2" type="StaticBody3D" parent="." groups=["interactables"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 3, 0.8, -2)
collision_layer = 2
collision_mask = 0
script = ExtResource("4_interact")
interaction_prompt = "Press [E] to pick up ammo"
one_time_use = true

[node name="MeshInstance3D" type="MeshInstance3D" parent="PickupExample2"]
mesh = SubResource("SphereMesh_pickup")

[node name="CollisionShape3D" type="CollisionShape3D" parent="PickupExample2"]
shape = SubResource("SphereShape3D_pickup")

[node name="CrateExample" type="StaticBody3D" parent="." groups=["interactables"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.5, 3)
collision_layer = 2
collision_mask = 0
script = ExtResource("4_interact")
interaction_prompt = "Press [E] to examine crate"

[node name="MeshInstance3D" type="MeshInstance3D" parent="CrateExample"]
mesh = SubResource("BoxMesh_crate")

[node name="CollisionShape3D" type="CollisionShape3D" parent="CrateExample"]
shape = SubResource("BoxShape3D_crate")

[node name="Player" type="CharacterBody3D" parent="." groups=["player"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 8)
script = ExtResource("1_controller")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Player"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("CapsuleShape3D_player")

[node name="Camera3D" type="Camera3D" parent="Player"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.6, 0)

[node name="InteractionRaycast" type="RayCast3D" parent="Player/Camera3D"]
script = ExtResource("2_raycast")
interaction_distance = 3.0

[node name="DebugOverlay" type="CanvasLayer" parent="."]
script = ExtResource("3_debug")

[node name="MarginContainer" type="MarginContainer" parent="DebugOverlay"]
offset_left = 10.0
offset_top = 10.0
offset_right = 350.0
offset_bottom = 200.0
theme_override_constants/margin_left = 10
theme_override_constants/margin_top = 10

[node name="VBoxContainer" type="VBoxContainer" parent="DebugOverlay/MarginContainer"]
layout_mode = 2

[node name="FPSLabel" type="Label" parent="DebugOverlay/MarginContainer/VBoxContainer"]
layout_mode = 2
theme_override_colors/font_color = Color(0, 1, 0, 1)
text = "FPS: 60"

[node name="DebugLabel" type="Label" parent="DebugOverlay/MarginContainer/VBoxContainer"]
layout_mode = 2
theme_override_colors/font_color = Color(1, 1, 1, 1)
text = "Position: (0.0, 0.0, 0.0)
Velocity: (0.0, 0.0, 0.0)
Speed: 0.0 m/s
On Floor: true
Crouching: false
Sprinting: false"

[node name="InfoLabel" type="Label" parent="DebugOverlay"]
anchors_preset = 7
anchor_left = 0.5
anchor_top = 1.0
anchor_right = 0.5
anchor_bottom = 1.0
offset_left = -200.0
offset_top = -80.0
offset_right = 200.0
offset_bottom = -20.0
grow_horizontal = 2
grow_vertical = 0
theme_override_colors/font_color = Color(1, 1, 1, 1)
text = "Stage 1 Test Scene
WASD: Move | Shift: Sprint | C/Ctrl: Crouch
Space: Jump | E: Interact | ~: Toggle Debug
ESC: Release Mouse"
horizontal_alignment = 1
vertical_alignment = 1
